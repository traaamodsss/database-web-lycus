<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - Database Dashboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    :root { --primary: #4361ee; --danger: #ef4444; --success: #10b981; --warning: #f59e0b; --dark: #1e293b; }
    body { font-family: 'Poppins', sans-serif; background-color: #f1f5f9; padding: 20px; }
    .container { max-width: 1000px; margin: auto; }
    .header { background: linear-gradient(135deg, var(--primary), #3f37c9); color: white; padding: 30px; border-radius: 1.5rem; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
    .card { background: white; padding: 25px; border-radius: 1.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    .alert { background: #dcfce7; color: #166534; padding: 15px; border-radius: 1rem; margin-bottom: 20px; text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 12px; border-bottom: 1px solid #e2e8f0; text-align: left; }
    .btn { border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; color: white; font-weight: 500; }
    .btn-danger { background: var(--danger); }
    .btn-success { background: var(--success); }
    .btn-warning { background: var(--warning); }
    .form-add { display: flex; gap: 10px; margin-bottom: 20px; }
    .input-control { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <h1 id="title">Dashboard</h1>
        <p>Kelola database nomor kamu</p>
      </div>
      <a href="/logout" style="color: white; text-decoration: none; font-weight: bold;"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>

    <% if (message) { %> <div class="alert"><%= message %></div> <% } %>

    <div class="card">
      <form action="/aksi-tambah" method="POST" class="form-add">
        <input type="text" name="number" class="input-control" placeholder="Contoh: 628384xxx" required>
        <button type="submit" class="btn btn-success">Tambah Nomor</button>
      </form>

      <input type="text" id="searchInput" onkeyup="filterTable()" class="input-control" placeholder="Cari nomor di tabel..." style="width: 100%;">

      <table id="numberTable">
        <thead>
          <tr>
            <th>Nomor</th>
            <th>Status</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
  <% data.forEach(item => { %>
    <tr>
      <td><%= item.number %></td>
      <td>
        <span class="status-badge status-<%= item.status %>">
          <%= item.status %>
        </span>
      </td>
      <td class="actions">
        <form action="/deletenumber" method="POST" style="display:inline;" onsubmit="return confirm('Yakin hapus?')">
          <input type="hidden" name="number" value="<%= item.number %>">
          <button type="submit" class="btn-action btn-danger"><i class="fas fa-trash"></i></button>
        </form>

        <form action="/statusnumber" method="POST" style="display:inline;">
          <input type="hidden" name="number" value="<%= item.number %>">
          <input type="hidden" name="status" value="<%= item.status === 'active' ? 'blacklist' : 'active' %>">
          <button type="submit" class="btn-action <%= item.status === 'active' ? 'btn-warning' : 'btn-success' %>">
            <i class="fas <%= item.status === 'active' ? 'fa-ban' : 'fa-check' %>"></i>
          </button>
        </form>
      </td>
    </tr>
  <% }) %>
</tbody>
      </table>
    </div>
  </div>

  <script>
    function filterTable() {
      const input = document.getElementById("searchInput");
      const filter = input.value.toLowerCase();
      const rows = document.querySelectorAll("#numberTable tbody tr");
      rows.forEach(row => {
        const text = row.cells[0].textContent.toLowerCase();
        row.style.display = text.includes(filter) ? "" : "none";
      });
    }
  </script>
</body>
</html>
